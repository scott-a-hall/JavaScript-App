var pokemonRepository = (function() {
  var e = [],
    t = "https://pokeapi.co/api/v2/pokemon/",
    n = document.querySelector("#modal-container");
  function i(t) {
    e.push(t);
  }
  function o(e) {
    var t = e.detailsUrl;
    return fetch(t)
      .then(function(e) {
        return e.json();
      })
      .then(function(t) {
        (e.imageUrl = t.sprites.front_default),
          (e.height = t.height),
          (e.types = []);
        for (var n = 0; n < t.types.length; n++)
          e.types.push(" " + t.types[n].type.name);
      })
      .catch(function(e) {
        console.error(e);
      });
  }
  function a() {
    n.classList.remove("is-visible");
  }
  return (
    window.addEventListener("keydown", e => {
      "Escape" === e.key && n.classList.contains("is-visible") && a();
    }),
    n.addEventListener("click", e => {
      e.target === n && a();
    }),
    {
      add: i,
      getAll: function() {
        return e;
      },
      addListItem: function(e) {
        var t = document.querySelector(".pokemon-list"),
          i = document.createElement("li"),
          r = document.createElement("button");
        (r.innerText = e.name),
          r.classList.add("button"),
          i.appendChild(r),
          t.appendChild(i),
          r.addEventListener("click", function() {
            var t;
            o((t = e)).then(function() {
              !(function(e) {
                n.innerHTML = "";
                var t = document.createElement("div");
                t.classList.add("modal");
                var i = document.createElement("button");
                i.classList.add("modal-close"),
                  (i.innerText = "Close"),
                  i.addEventListener("click", a);
                var o = document.createElement("h1");
                o.innerText = e.name;
                var r = document.createElement("p");
                r.innerText = "Height: " + e.height + " m";
                var c = document.createElement("p");
                c.innerText = "Type: " + e.types;
                var s = document.createElement("img");
                s.classList.add("modal-image"),
                  s.setAttribute("src", e.imageUrl),
                  t.appendChild(i),
                  t.appendChild(o),
                  t.appendChild(r),
                  t.appendChild(c),
                  t.appendChild(s),
                  n.appendChild(t),
                  n.classList.add("is-visible");
              })(t);
            });
          });
      },
      loadList: function() {
        return fetch(t)
          .then(function(e) {
            return e.json();
          })
          .then(function(e) {
            e.results.forEach(function(e) {
              i({ name: e.name, detailsUrl: e.url });
            });
          })
          .catch(function(e) {
            console.error(e);
          });
      },
      loadDetails: o
    }
  );
})();
pokemonRepository.loadList().then(function() {
  pokemonRepository.getAll().forEach(function(e) {
    pokemonRepository.addListItem(e);
  });
});
